---
- hosts: monitoring-machine
  become: yes
  become_user: root
  become_method: sudo
  roles:
    - alertmanager

- hosts: nodes
  become: yes
  become_user: root
  become_method: sudo
  roles:
    - prometheus_node_exporter

- hosts: monitoring-machine
  become: yes
  become_user: root
  become_method: sudo
  roles:
    - prometheus_node_exporter    

- name: Prometheus Installation
  hosts: monitoring-machine  # <-- Specify your target host or group here
  become: yes
  become_user: root
  become_method: sudo
  roles:
    - prometheus


# - hosts: monitoring-machine
#   become: yes
#   become_user: root
#   become_method: sudo
#   roles:
#     - prometheus

# - hosts: monitoring-machine
#   become: yes
#   become_user: root
#   become_method: sudo
#   roles:
#     - grafana

- hosts: monitoring-machine
  become: yes
  become_user: root
  become_method: sudo
- name: Install Grafana
  vars:
    grafana_release_tag: "4.6.3"
  roles:
    - { role: ansible-grafana }